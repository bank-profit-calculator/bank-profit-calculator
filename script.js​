// 🏦 بيانات البنوك والشهادات
const bankCertificates = [
  {
    bank: "بنك مصر",
    certificates: [
      { name: "الشهادة الثلاثية", rate: 19, type: "شهادة", pros: "عائد ثابت طوال المدة", cons: "لا يمكن كسرها قبل 6 شهور" },
      { name: "شهادة القمة", rate: 17, type: "شهادة", pros: "عائد شهري ممتاز", cons: "مناسبة للمبالغ الكبيرة فقط" },
      { name: "وديعة قصيرة الأجل", rate: 13, type: "وديعة", pros: "مرونة في المدة", cons: "عائد أقل من الشهادات" }
    ]
  },
  {
    bank: "البنك الأهلي المصري",
    certificates: [
      { name: "شهادة الاستثمار", rate: 18.5, type: "شهادة", pros: "عائد مجزي", cons: "لا يمكن كسرها قبل المدة" },
      { name: "وديعة 6 شهور", rate: 12.75, type: "وديعة", pros: "فترة قصيرة", cons: "عائد قليل نسبيًا" }
    ]
  }
];

// 🧩 تعبئة قائمة البنوك
function populateBanks() {
  const bankSelect = document.getElementById("bank");
  bankCertificates.forEach(bank => {
    const option = document.createElement("option");
    option.value = bank.bank;
    option.text = bank.bank;
    bankSelect.appendChild(option);
  });
}

// 🧩 تعبئة الشهادات عند اختيار بنك + فلترة حسب النوع
function updateCertificates() {
  const bankName = document.getElementById("bank").value;
  const certificateSelect = document.getElementById("certificate");
  const selectedFilter = document.querySelector('input[name="filterType"]:checked')?.value;

  certificateSelect.innerHTML = "<option disabled selected>اختر شهادة / وديعة</option>";

  const selectedBank = bankCertificates.find(bank => bank.bank === bankName);

  if (selectedBank) {
    let filteredCertificates = selectedBank.certificates;

    if (selectedFilter !== "all") {
      filteredCertificates = filteredCertificates.filter(cert => cert.type === selectedFilter);
    }

    filteredCertificates.forEach(cert => {
      const option = document.createElement("option");
      option.value = cert.name;
      option.text = `${cert.name} (${cert.type})`;
      certificateSelect.appendChild(option);
    });
  }
}

// 📊 تعيين نسبة الفائدة تلقائيًا بعد اختيار الشهادة
function setRateFromCertificate() {
  const bankName = document.getElementById("bank").value;
  const certName = document.getElementById("certificate").value;
  const rateInput = document.getElementById("rate");

  const selectedBank = bankCertificates.find(bank => bank.bank === bankName);
  const selectedCert = selectedBank.certificates.find(cert => cert.name === certName);

  if (selectedCert) {
    rateInput.value = selectedCert.rate;
  }
}

// 💸 حساب العائد
function calculateInterest() {
  let amount = parseFloat(document.getElementById("amount").value);
  let rate = parseFloat(document.getElementById("rate").value);
  let period = document.querySelector('input[name="period"]:checked')?.value;
  let currency = document.getElementById("currency").value;

  if (isNaN(amount) || isNaN(rate) || !period) {
    document.getElementById("result").innerText = "يرجى إدخال البيانات بشكل صحيح.";
    return;
  }

  let yearlyInterest = (amount * rate) / 100;
  let result;

  if (period === "daily") {
    result = yearlyInterest / 365;
  } else if (period === "monthly") {
    result = yearlyInterest / 12;
  } else {
    result = yearlyInterest;
  }

  document.getElementById("result").innerText =
    `💡 العائد ${getPeriodName(period)}: ${result.toFixed(2)} ${getCurrencySymbol(currency)}`;
}

// 🔄 اسم الفترة حسب النوع
function getPeriodName(value) {
  switch (value) {
    case 'daily': return 'اليومي';
    case 'monthly': return 'الشهري';
    case 'yearly': return 'السنوي';
    default: return '';
  }
}

// 💱 رمز العملة
function getCurrencySymbol(code) {
  switch (code) {
    case 'EGP': return 'جنيه';
    case 'USD': return '$';
    case 'SAR': return 'ر.س';
    case 'EUR': return '€';
    default: return '';
  }
}

// 🌙 تبديل الوضع الليلي
function toggleTheme() {
  document.body.classList.toggle('dark');
  const btn = document.getElementById("toggleTheme");
  btn.innerText = document.body.classList.contains("dark") ? "☀️ الوضع النهاري" : "🌙 الوضع الليلي";
}

// ✅ تحميل البيانات عند فتح الصفحة
window.onload = function () {
  populateBanks();
};
